import{d as J,aj as O,ak as P,J as Q,r as c,x as W,y as F,c as s,h as Y,a as n,b as p,e as i,w as X,T as Z,al as ee,N as te,o as u,K as oe,Q as r,F as M,l as N,t as q,S as j,R as T,V as A}from"./CNNffg5U.js";import{_ as ae,i as v}from"./B3usRQSs.js";import{_ as ne}from"./BlOCDgWl.js";import{_ as le}from"./DVW9z85d.js";import{_ as ie,a as se}from"./DOhMkyku.js";import{s as ue,a as re}from"./DLgMY6mf.js";import{$ as L,a as K}from"./CVQPREqV.js";import{y as f,u as I}from"./2gKM0m1V.js";import{u as de}from"./Lo25e5TF.js";import"./DvXkyWUv.js";import"./Xy0_oFzj.js";const pe={key:0,class:"relative flex flex-col w-full max-w-3xl p-3 mx-auto overflow-hidden"},be={class:"flex justify-center py-4"},_e=["value"],me=["value"],ce={class:"flex flex-col gap-8 pb-4"},Le=J({__name:"books",async setup(ve){let k,S;const D=O(),{data:l,pending:R}=([k,S]=P(()=>de("/api/user/books/".concat(D.params.id),"$zf7YHpGOWq")),k=await k,S(),k),U=Q(),_=c(!1);let E=c("");const y=c(new L(f(l.value.book_start_date).year,f(l.value.book_start_date).month,f(l.value.book_start_date).day)),b=c(l.value.book_end_date||l.value.book_end_date===""?new L(f(l.value.book_end_date).year,f(l.value.book_end_date).month,f(l.value.book_end_date).day):""),B=c(),x=c(),h=c(""),t=W({book_author:"",book_image:"",book_start_date:x.value,book_end_date:h.value,book_title:"",booklist:!1,kind_of_book:"",notes:""});F(b,()=>{var e,o,w,d,g,V,$;(e=b.value)!=null&&e.year&&((o=b.value)!=null&&o.month)&&((w=b.value)!=null&&w.day)&&(B.value=new L((d=b.value)==null?void 0:d.year,(g=b.value)==null?void 0:g.month,(V=b.value)==null?void 0:V.day),h.value=($=I(B.value.toDate(K())))!=null?$:"",t.book_end_date=h.value)},{immediate:!0}),F(y,()=>{var e;x.value=(e=I(y.value.toDate(K())))!=null?e:"",t.book_start_date=x.value},{immediate:!0}),l.value&&(t.book_author=l.value.book_author,t.book_start_date=x.value,t.book_end_date=h.value,t.book_image=l.value.book_image,t.book_title=l.value.book_title,t.booklist=l.value.booklist==="true",t.kind_of_book=l.value.kind_of_book,t.notes=l.value.notes);async function z(){_.value=!0,$fetch("/api/user/books/".concat(D.params.id,"/books"),{method:"PUT",body:t}).then(async()=>{await A("/dashboard/mind")}).catch(async e=>{U.error("Failed to update","Try again"),console.log(e),E.value=e.statusMessage,_.value=!1})}async function G(){_.value=!0,$fetch("/api/user/books/".concat(D.params.id),{method:"DELETE",body:t}).then(async()=>{await A("/dashboard/mind")}).catch(async e=>{U.error("Failed to delete","Try again"),console.log(e),E.value=e.statusMessage,_.value=!1})}return(e,o)=>{var C;const w=ee,d=ae,g=ne,V=le,$=ie,H=se,m=te("motion");return n(R)?Y("",!0):(u(),s("div",pe,[p("div",be,[i(w,{class:"object-cover h-60",src:(C=n(l))==null?void 0:C.book_image,format:"webp",preload:"",loading:"eager","fetch-priority":"high"},null,8,["src"])]),i(Z,{name:"slide-up",mode:"out-in"},{default:X(()=>[p("form",{onSubmit:oe(z,["prevent"]),class:"space-y-6"},[r((u(),s("div",null,[i(d,{text:"Kind of book"}),r(p("select",{id:"status-select","onUpdate:modelValue":o[0]||(o[0]=a=>n(t).kind_of_book=a),required:"",class:"w-full rounded-xl border border-gray-600 bg-gray-700/50 py-3 px-4 text-lg text-white shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"},[o[7]||(o[7]=p("option",{disabled:"",value:""},"Kind of book",-1)),(u(!0),s(M,null,N(n(ue),a=>(u(),s("option",{value:a.value,key:a.label},q(a.label),9,_e))),128))],512),[[j,n(t).kind_of_book]])])),[[m,{...("inputVarient"in e?e.inputVarient:n(v))()}]]),r((u(),s("div",null,[i(d,{text:"Save for future reads"}),r(p("select",{id:"status-select","onUpdate:modelValue":o[1]||(o[1]=a=>n(t).booklist=a),required:"",class:"w-full rounded-xl border border-gray-600 bg-gray-700/50 py-3 px-4 text-lg text-white shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"},[o[8]||(o[8]=p("option",{disabled:"",value:""},"No",-1)),(u(!0),s(M,null,N(n(re),a=>(u(),s("option",{value:a.value,key:a.label},q(a.label),9,me))),128))],512),[[j,n(t).booklist]])])),[[m,{...("inputVarient"in e?e.inputVarient:n(v))()}]]),r((u(),s("div",null,[i(d,{text:"Title"}),r(p("input",{id:"text",type:"text","onUpdate:modelValue":o[2]||(o[2]=a=>n(t).book_title=a),placeholder:"Title",required:"",class:"w-full rounded-xl border border-gray-600 bg-gray-700/50 py-3 px-4 text-lg text-white shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[T,n(t).book_title]])])),[[m,{...("inputVarient"in e?e.inputVarient:n(v))()}]]),r((u(),s("div",null,[i(d,{text:"Author"}),r(p("input",{id:"text",type:"text","onUpdate:modelValue":o[3]||(o[3]=a=>n(t).book_author=a),placeholder:"Author",required:"",class:"w-full rounded-xl border border-gray-600 bg-gray-700/50 py-3 px-4 text-lg text-white shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[T,n(t).book_author]])])),[[m,{...("inputVarient"in e?e.inputVarient:n(v))()}]]),r((u(),s("div",null,[i(d,{text:"Notes"}),r(p("textarea",{id:"text",type:"text","onUpdate:modelValue":o[4]||(o[4]=a=>n(t).notes=a),placeholder:"Book notes",class:"w-full rounded-xl border border-gray-600 bg-gray-700/50 py-3 px-4 text-lg text-white shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[T,n(t).notes]])])),[[m,{...("inputVarient"in e?e.inputVarient:n(v))()}]]),r((u(),s("div",null,[i(d,{text:"Start"}),i(g,{modelValue:y.value,"onUpdate:modelValue":o[5]||(o[5]=a=>y.value=a),icon:"i-lucide-calendar"},null,8,["modelValue"])])),[[m,{...("inputVarient"in e?e.inputVarient:n(v))()}]]),r((u(),s("div",null,[i(d,{text:"End"}),i(g,{modelValue:b.value,"onUpdate:modelValue":o[6]||(o[6]=a=>b.value=a),icon:"i-lucide-calendar"},null,8,["modelValue"])])),[[m,{...("inputVarient"in e?e.inputVarient:n(v))()}]]),p("div",ce,[i(V,{text:"Save",isLoading:_.value},null,8,["isLoading"]),i($,{text:"Cancel",path:"/dashboard/mind",isLoading:_.value},null,8,["isLoading"]),i(H,{onClick:G,text:"Delete",isLoading:_.value},null,8,["isLoading"])])],32)]),_:1})]))}}});export{Le as default};
