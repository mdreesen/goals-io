import{e as H,am as J,an as Q,f as W,J as Y,q as c,s as X,v as E,c as i,i as Z,g as o,a as d,b as s,w as ee,T as te,R as oe,M as ae,o as u,K as ne,O as r,F as M,r as B,t as C,Q as F,P as w,a3 as N}from"./BEJcgv1L.js";import{_ as le,i as v}from"./l_evH6QZ.js";import{_ as se}from"./voOrqBb7.js";import{_ as ie}from"./DxaSkOH5.js";import{_ as ue,a as re}from"./DXDRtoTA.js";import{s as de,a as pe}from"./DLgMY6mf.js";import{$ as V,b as q}from"./Kz2Pg0ku.js";import{y as f,u as A}from"./BGMpC11e.js";import{u as be}from"./eP-uZObp.js";import{r as K}from"./rJrebWa7.js";import"./DvXkyWUv.js";const _e={key:0,class:"relative flex flex-col w-full max-w-3xl p-3 mx-auto overflow-hidden"},me={class:"flex justify-center py-4"},ce=["value"],ve=["value"],fe={class:"flex flex-col gap-8 pb-4"},Ue=H({__name:"books",async setup(ge){let g,D;const h=J(),{data:l,pending:j}=([g,D]=Q(()=>be(`/api/user/books/${h.params.id}`,"$zf7YHpGOWq")),g=await g,D(),g),{fetch:$}=W(),S=Y(),p=c(!1);let T=c("");const k=c(new V(f(l.value.book_start_date).year,f(l.value.book_start_date).month,f(l.value.book_start_date).day)),b=c(l.value.book_end_date||l.value.book_end_date===""?new V(f(l.value.book_end_date).year,f(l.value.book_end_date).month,f(l.value.book_end_date).day):""),L=c(),y=c(),x=c(""),e=X({book_author:"",book_image:"",book_start_date:y.value,book_end_date:x.value,book_title:"",booklist:!1,kind_of_book:"",notes:""});E(b,()=>{b.value?.year&&b.value?.month&&b.value?.day&&(L.value=new V(b.value?.year,b.value?.month,b.value?.day),x.value=A(L.value.toDate(q()))??"",e.book_end_date=x.value)},{immediate:!0}),E(k,()=>{y.value=A(k.value.toDate(q()))??"",e.book_start_date=y.value},{immediate:!0}),l.value&&(e.book_author=l.value.book_author,e.book_start_date=y.value,e.book_end_date=x.value,e.book_image=l.value.book_image,e.book_title=l.value.book_title,e.booklist=l.value.booklist==="true",e.kind_of_book=l.value.kind_of_book,e.notes=l.value.notes);async function I(){p.value=!0,$fetch(`/api/user/books/${h.params.id}/books`,{method:"PUT",body:e}).then(async()=>{await $(),await K(),await N("/dashboard/mind"),p.value=!1}).catch(async a=>{S.error("Failed to update","Try again"),console.log(a),T.value=a.statusMessage,p.value=!1})}async function O(){p.value=!0,$fetch(`/api/user/books/${h.params.id}`,{method:"DELETE",body:e}).then(async()=>{await $(),await K(),p.value=!1,await N("/dashboard/mind")}).catch(async a=>{S.error("Failed to delete","Try again"),console.log(a),T.value=a.statusMessage,p.value=!1})}return(a,n)=>{const P=oe,_=le,U=se,R=ie,z=ue,G=re,m=ae("motion");return o(j)?Z("",!0):(u(),i("div",_e,[d("div",me,[s(P,{class:"object-cover h-60",src:o(l)?.book_image},null,8,["src"])]),s(te,{name:"slide-up",mode:"out-in"},{default:ee(()=>[d("form",{onSubmit:ne(I,["prevent"]),class:"space-y-6"},[r((u(),i("div",null,[s(_,{text:"Kind of book"}),r(d("select",{id:"status-select","onUpdate:modelValue":n[0]||(n[0]=t=>o(e).kind_of_book=t),required:"",class:"w-full rounded-xl border border-gray-600 bg-gray-700/50 py-3 px-4 text-lg text-white shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"},[n[7]||(n[7]=d("option",{disabled:"",value:""},"Kind of book",-1)),(u(!0),i(M,null,B(o(de),t=>(u(),i("option",{value:t.value,key:t.label},C(t.label),9,ce))),128))],512),[[F,o(e).kind_of_book]])])),[[m,{...("inputVarient"in a?a.inputVarient:o(v))()}]]),r((u(),i("div",null,[s(_,{text:"Save for future reads"}),r(d("select",{id:"status-select","onUpdate:modelValue":n[1]||(n[1]=t=>o(e).booklist=t),required:"",class:"w-full rounded-xl border border-gray-600 bg-gray-700/50 py-3 px-4 text-lg text-white shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"},[n[8]||(n[8]=d("option",{disabled:"",value:""},"No",-1)),(u(!0),i(M,null,B(o(pe),t=>(u(),i("option",{value:t.value,key:t.label},C(t.label),9,ve))),128))],512),[[F,o(e).booklist]])])),[[m,{...("inputVarient"in a?a.inputVarient:o(v))()}]]),r((u(),i("div",null,[s(_,{text:"Title"}),r(d("input",{id:"text",type:"text","onUpdate:modelValue":n[2]||(n[2]=t=>o(e).book_title=t),placeholder:"Title",required:"",class:"w-full rounded-xl border border-gray-600 bg-gray-700/50 py-3 px-4 text-lg text-white shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[w,o(e).book_title]])])),[[m,{...("inputVarient"in a?a.inputVarient:o(v))()}]]),r((u(),i("div",null,[s(_,{text:"Author"}),r(d("input",{id:"text",type:"text","onUpdate:modelValue":n[3]||(n[3]=t=>o(e).book_author=t),placeholder:"Author",required:"",class:"w-full rounded-xl border border-gray-600 bg-gray-700/50 py-3 px-4 text-lg text-white shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[w,o(e).book_author]])])),[[m,{...("inputVarient"in a?a.inputVarient:o(v))()}]]),r((u(),i("div",null,[s(_,{text:"Notes"}),r(d("textarea",{id:"text",type:"text","onUpdate:modelValue":n[4]||(n[4]=t=>o(e).notes=t),placeholder:"Book notes",class:"w-full rounded-xl border border-gray-600 bg-gray-700/50 py-3 px-4 text-lg text-white shadow-lg transition-all duration-300 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[w,o(e).notes]])])),[[m,{...("inputVarient"in a?a.inputVarient:o(v))()}]]),r((u(),i("div",null,[s(_,{text:"Start"}),s(U,{modelValue:k.value,"onUpdate:modelValue":n[5]||(n[5]=t=>k.value=t),icon:"i-lucide-calendar"},null,8,["modelValue"])])),[[m,{...("inputVarient"in a?a.inputVarient:o(v))()}]]),r((u(),i("div",null,[s(_,{text:"End"}),s(U,{modelValue:b.value,"onUpdate:modelValue":n[6]||(n[6]=t=>b.value=t),icon:"i-lucide-calendar"},null,8,["modelValue"])])),[[m,{...("inputVarient"in a?a.inputVarient:o(v))()}]]),d("div",fe,[s(R,{text:"Save",isLoading:p.value},null,8,["isLoading"]),s(z,{text:"Cancel",path:"/dashboard/mind",isLoading:p.value},null,8,["isLoading"]),s(G,{onClick:O,text:"Delete",isLoading:p.value},null,8,["isLoading"])])],32)]),_:1})]))}}});export{Ue as default};
